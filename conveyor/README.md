# conveyor  

Микросервис - конвейер, в котором проиходит  скоринг пользовательских данных и расчет параметров кредита.

Сначала происходит прескоринг данных, после чего генерируются кредитные предложения. После происходит скоринг с учетом всех данных пользователя. 

Окружение и запуск
-
Приложение использует openapi generator, поэтому перед запуском необходимо сгенерировать нужные файлы. Это можно сделать maven командой `mvn clean install
`

API
-
`POST: /conveyor/offers` - производит прескоринг данных и возращает 4 кредитных предложения.

`POST: /conveyor/calculation` - производит скоринг данных и возращает объект со все высчитанными параметрами кредита. В случае отказа в выдаче возвращает соответствующее сообщение с указанием причин отказа. 

Правила прескоринга
-
`Имя`, `Фамилия` - от 2 до 30 латинских букв. 

`Отчество`, при наличии - от 2 до 30 латинских букв.

`Сумма кредита` - действительно число, большее или равное 10000.

`Срок кредита` - целое число, большее или равное 6.

`Дата рождения` - число в формате гггг-мм-дд, не позднее 18 лет с текущего дня.

`Email адрес` - строка, подходящая под паттерн [\w\.]{2,50}@[\w\.]{2,20}

`Серия паспорта` - 4 цифры.

`Номер паспорта` - 6 цифр.

Правила скоринга
- 
`Безработный` - отказ.

`Владелец бизнеса` - кредитная ставка увеличена на 3 процента.

`Менеджер среднего звена` - кредитная ставка уменьшена на 2 процента.

`Разведен` - кредитная ставка увеличена на 1 процент.

`Число иждивенцев` больше 1 - кредитная ставка увеличена на 1 процент.

Расчет параметров кредита
- 
* Для расчета `ПСК` использована упрощенная формула
  
  `ПСК` = $\frac{\frac{S}{S_{0}} - 1}{n}$ где

  $`S_{0}`$ - сумма кредита

  $`S`$ - сумма всех выплат

  $`n`$ - срок кредитования в годах

* Ежемесячные выплаты расчитывались для аннуитетного графика
  
  `p` = $S \frac{rate * (1 + rate)^{term}}{(1 + rate)^{term} - 1}$ где

  `S` - сумма кредита

  `rate` - месячная процентная ставка

  `term` - срок кредитования в месяцах

* Процентная часть долга считалась по формуле
  
  `inretestPayment` = $remainig * rate$ где

  `remainig` - оставшая сумма долга

  `rate` - месячная процентная ставка 
Ссылки полезные
-
* https://www.raiffeisen.ru/wiki/kak-rasschitat-procenty-po-kreditu/
* https://temabiz.com/finterminy/psk-uproshhennyj-raschet.html
